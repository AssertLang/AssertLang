# Complete Language Support in Promptware

## All Supported Backend Languages

Promptware supports **8 backend languages** (with varying levels of completion):

### Tier 1: Production-Ready (Wave 1-2)
1. **Python** âœ…
2. **Node.js** âœ…
3. **Go** âœ…

### Tier 2: In Progress (Wave 2-3)
4. **Rust** ğŸ”¨
5. **.NET** (C#) ğŸ”¨

### Tier 3: Planned (Wave 3-4)
6. **Java** ğŸ“‹
7. **C++** ğŸ“‹
8. **Next.js** (specialized Node variant) ğŸ“‹

---

## Current Implementation Status

### What's Actually Built

From the codebase audit:

**Runners** (execution environments):
```
runners/
  python/     âœ… Full implementation
  node/       âœ… Full implementation
  go/         âœ… Full implementation
  dotnet/     ğŸ”¨ Partial implementation
```

**Tool Adapters** (36 tools Ã— 5 languages = 180 adapters):
```
tools/
  <tool_name>/
    adapters/
      adapter_py.py      âœ… Python
      adapter_node.js    âœ… Node.js
      adapter_go.go      âœ… Go
      adapter_rust.rs    âœ… Rust
      Adapter.cs         âœ… .NET
```

**CLI Support**:
```bash
--lang python   âœ…
--lang node     âœ…
--lang nextjs   âœ… (Node variant)
--lang go       âœ…
--lang rust     ğŸ”¨
--lang java     ğŸ“‹
--lang .net     ğŸ”¨
--lang cpp      ğŸ“‹
```

---

## Language-by-Language Breakdown

### 1. Python âœ…

**Status**: Fully working

**Runner**: `runners/python/runner.py`
- Protocol: JSON-RPC over stdin/stdout
- Methods: `apply`, `start`, `stop`, `health`
- Dependency management: `pip install -r requirements.txt`

**Example .pw**:
```pw
lang python
start python app.py

file app.py:
  from flask import Flask
  app = Flask(__name__)

dep python requirements flask==3.0.0
```

**Generated code location**: `.mcpd/<task_id>/source/app.py`

**Adapters**: All 36 tools have Python adapters

---

### 2. Node.js âœ…

**Status**: Fully working

**Runner**: `runners/node/runner.js`
- Protocol: JSON-RPC over stdin/stdout
- Methods: `apply`, `start`, `stop`, `health`
- Dependency management: `npm install <packages>`

**Example .pw**:
```pw
lang node
start node server.js

file server.js:
  const express = require('express');
  const app = express();

dep node packages express@4.18.0
```

**Generated code location**: `.mcpd/<task_id>/source/server.js`

**Adapters**: All 36 tools have Node adapters

---

### 3. Go âœ…

**Status**: Fully working

**Runner**: `runners/go/runner.go`
- Protocol: JSON-RPC over stdin/stdout
- Methods: `apply`, `start`, `stop`, `health`
- Dependency management: ephemeral `go.mod` generated by daemon

**Example .pw**:
```pw
lang go
start go run main.go

file main.go:
  package main
  import (
    "fmt"
    "net/http"
  )
  func main() {
    http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
      fmt.Fprint(w, "Hello")
    })
    http.ListenAndServe(":8000", nil)
  }

dep go modules github.com/gorilla/mux@v1.8.0
```

**Generated code location**: `.mcpd/<task_id>/source/main.go`

**Adapters**: All 36 tools have Go adapters

---

### 4. Rust ğŸ”¨

**Status**: Adapters built, runner partial

**Runner**: Not yet in `runners/` directory, but adapters exist

**What exists**:
- âœ… Tool adapters: All 36 tools have `adapter_rust.rs`
- âœ… Template spec: `docs/toolgen-rust-adapter-template.md`
- âœ… Smoke tests: `tests/tools/test_rust_adapters.py`
- ğŸ”¨ Runner implementation: Planned for M3 (Wave 3)

**Planned .pw syntax**:
```pw
lang rust
start cargo run

file main.rs:
  use std::net::TcpListener;
  fn main() {
    let listener = TcpListener::bind("127.0.0.1:8000").unwrap();
    // ...
  }

dep rust crates serde=1.0 tokio=1.28
```

**Dependency management**: Daemon generates `Cargo.toml`

**Target**: Axum framework, WASI for security

---

### 5. .NET (C#) ğŸ”¨

**Status**: Adapters built, runner partial

**Runner**: `runners/dotnet/` exists but partial implementation

**What exists**:
- âœ… Tool adapters: All 36 tools have `Adapter.cs`
- âœ… Template spec: `docs/toolgen-dotnet-adapter-template.md`
- âœ… Smoke tests: `tests/tools/test_dotnet_adapters.py`
- ğŸ”¨ Runner implementation: In progress

**Planned .pw syntax**:
```pw
lang .net
start dotnet run

file Program.cs:
  var builder = WebApplication.CreateBuilder(args);
  var app = builder.Build();
  app.MapGet("/", () => "Hello");
  app.Run();

dep dotnet packages Microsoft.AspNetCore.App@8.0.0
```

**Dependency management**: SDK-style projects targeting `net7.0` or `net8.0`

**Target**: ASP.NET Core minimal APIs

---

### 6. Java ğŸ“‹

**Status**: Planned for M4 (Wave 4)

**Runner**: Not yet built

**What exists**:
- ğŸ“‹ CLI support: `--lang java` accepted
- ğŸ“‹ Adapters: Not yet generated
- ğŸ“‹ Runner: Planned

**Planned .pw syntax**:
```pw
lang java
start java Main

file Main.java:
  import com.sun.net.httpserver.*;
  public class Main {
    public static void main(String[] args) throws Exception {
      HttpServer server = HttpServer.create(new InetSocketAddress(8000), 0);
      server.createContext("/", exchange -> {
        byte[] resp = "Hello".getBytes();
        exchange.sendResponseHeaders(200, resp.length);
        exchange.getResponseBody().write(resp);
      });
      server.start();
    }
  }

dep java maven com.sun.net.httpserver:jdk.httpserver:11.0
```

**Target timeline**: M4 (10-16 weeks)

---

### 7. C++ ğŸ“‹

**Status**: Planned for future waves

**Runner**: Not yet built

**What exists**:
- ğŸ“‹ CLI support: `--lang cpp` accepted
- ğŸ“‹ Adapters: Not yet generated
- ğŸ“‹ Runner: Planned

**Planned .pw syntax**:
```pw
lang cpp
start ./app

file main.cpp:
  #include <iostream>
  #include <cpprest/http_listener.h>

  using namespace web;
  using namespace web::http;
  using namespace web::http::experimental::listener;

  int main() {
    http_listener listener("http://127.0.0.1:8000");
    listener.support(methods::GET, [](http_request request) {
      request.reply(status_codes::OK, "Hello");
    });
    listener.open().wait();
    while(true);
  }

dep cpp cmake cpprestsdk@2.10.18
```

**Challenges**: Build complexity, dependency management

---

### 8. Next.js ğŸ“‹

**Status**: Specialized Node.js variant, partial support

**Runner**: Uses Node.js runner with Next.js-specific commands

**What exists**:
- ğŸ“‹ CLI support: `--lang nextjs` accepted
- ğŸ”¨ Partial implementation in old daemon code (removed in recent fix)
- ğŸ“‹ Full support: Planned

**Planned .pw syntax**:
```pw
lang nextjs
start npm run dev

file package.json:
  {
    "dependencies": {
      "next": "14.2.5",
      "react": "18.3.1"
    },
    "scripts": {
      "dev": "next dev -p $PORT"
    }
  }

file pages/index.js:
  export default function Home() {
    return <div>Hello from Next.js</div>
  }

dep node packages next@14.2.5 react@18.3.1
```

**Special considerations**: Build step, static generation, server-side rendering

---

## Multi-Language Tool Adapters

All **36 tools** have adapters for 5 languages:

### Tool Categories (2-3-4-5-6 framework)

**Family 2: HTTP & Networking**
- `http` (HTTP client)
- `rest.get`, `rest.post`, `rest.put`, `rest.delete`
- `rest.server` (HTTP server)
- `websocket`

**Family 3: Data & Storage**
- `storage.kv` (key-value store)
- `storage.db` (SQL database)
- `storage.blob` (object storage)
- `file_reader`
- `json_validator`

**Family 4: Authentication & Security**
- `api_auth`
- `encryption`
- `auth.oauth`
- `auth.jwt`

**Family 5: Observability**
- `tracer`
- `logger`
- `metrics`
- `healthcheck`

**Family 6: Advanced**
- `video`
- `plugin-manager`
- (more planned)

### Adapter Generation

Each tool has a YAML spec:
```yaml
# tools/http/spec.yaml
tool: http
description: HTTP client for making requests
inputs:
  - name: url
    type: string
    required: true
  - name: method
    type: string
    default: GET
outputs:
  - name: status
    type: integer
  - name: body
    type: string
```

Toolgen generates adapters:
```bash
python3 cli/toolgen.py tools/http --python
python3 cli/toolgen.py tools/http --node
python3 cli/toolgen.py tools/http --go
python3 cli/toolgen.py tools/http --rust
python3 cli/toolgen.py tools/http --dotnet
```

Output:
```
tools/http/adapters/
  adapter_py.py       âœ…
  adapter_node.js     âœ…
  adapter_go.go       âœ…
  adapter_rust.rs     âœ…
  Adapter.cs          âœ…
```

---

## Answer to Your Question: Pure .pw Without `lang`

### Current Reality (Wave 1-2)

You must specify language:
```pw
lang python  # â† Required
start python app.py
file app.py: ...
```

### Your Vision: Generate All Languages

**Can we do this?**
```pw
# No lang specified
start app

server http:
  route GET /: respond "Hello"
```

Then Promptware generates:
- `.mcpd/abc123/python/app.py`
- `.mcpd/abc123/node/server.js`
- `.mcpd/abc123/go/main.go`
- `.mcpd/abc123/rust/main.rs`
- `.mcpd/abc123/dotnet/Program.cs`
- `.mcpd/abc123/java/Main.java`
- `.mcpd/abc123/cpp/main.cpp`
- `.mcpd/abc123/nextjs/pages/index.js`

**YES - absolutely possible.**

### What Would Change

**Instead of**:
```pw
lang python
file app.py:
  from flask import Flask
  ...
```

**Write pure .pw abstractions**:
```pw
server http port=8080:
  route GET /:
    respond "Hello"

  route POST /users:
    let user = ${request.body}
    call db.insert table="users" data=${user}
    respond json(${user})

storage db:
  connection postgres://localhost/mydb
```

**Toolgen generates for ALL languages**:

**Python version**:
```python
from flask import Flask, request
app = Flask(__name__)

@app.route('/')
def index():
    return "Hello"

@app.route('/users', methods=['POST'])
def create_user():
    user = request.get_json()
    # db.insert logic
    return user
```

**Node version**:
```javascript
const express = require('express');
const app = express();

app.get('/', (req, res) => {
    res.send("Hello");
});

app.post('/users', (req, res) => {
    const user = req.body;
    // db.insert logic
    res.json(user);
});
```

**Go version**:
```go
package main
import "net/http"

func main() {
    http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
        w.Write([]byte("Hello"))
    })
    http.HandleFunc("/users", func(w http.ResponseWriter, r *http.Request) {
        // parse body, db.insert logic
    })
    http.ListenAndServe(":8080", nil)
}
```

**Same for Rust, .NET, Java, C++, Next.js.**

---

## Implementation Roadmap

### Wave 1-2 (Current) âœ…
- 3 working runners: Python, Node, Go
- 5 languages with tool adapters: Python, Node, Go, Rust, .NET
- Manual `lang` specification required
- Manual code writing in `file` blocks

### Wave 3 (6-10 weeks) ğŸ”¨
- Rust runner complete
- Pure `.pw` abstractions for HTTP servers
- Optional `lang` directive (defaults to all)
- Single-language generation with abstractions

### Wave 4 (10-16 weeks) ğŸ“‹
- Java and C++ runners
- Multi-language simultaneous generation
- Gateway serves all language versions
- Next.js specialized support

### Wave 5+ (Future) ğŸ”®
- Polyglot imports (`import python "model.py"`)
- Foreign function interfaces
- Cross-language orchestration
- `.pw` as universal glue language

---

## Complete Language Matrix

| Language | Runner | Adapters | CLI | Status | Timeline |
|----------|--------|----------|-----|--------|----------|
| **Python** | âœ… | âœ… 36/36 | âœ… | Production | M1 (Done) |
| **Node.js** | âœ… | âœ… 36/36 | âœ… | Production | M2 (Done) |
| **Go** | âœ… | âœ… 36/36 | âœ… | Production | M2 (Done) |
| **Rust** | ğŸ”¨ | âœ… 36/36 | âœ… | In Progress | M3 (6-10w) |
| **.NET** | ğŸ”¨ | âœ… 36/36 | âœ… | In Progress | M4 (10-16w) |
| **Java** | ğŸ“‹ | âŒ 0/36 | âœ… | Planned | M4 (10-16w) |
| **C++** | ğŸ“‹ | âŒ 0/36 | âœ… | Planned | Future |
| **Next.js** | ğŸ”¨ | âœ… (Node) | âœ… | Partial | M3 (6-10w) |

**Legend**:
- âœ… Complete
- ğŸ”¨ In Progress
- ğŸ“‹ Planned
- âŒ Not Started

---

## Your Vision: All 8 Languages Simultaneously

**Today**:
```bash
promptware run app.pw --lang python
# Creates: .mcpd/abc123/source/app.py
# Serves: http://127.0.0.1:23456/apps/abc123/
```

**Your Vision**:
```bash
promptware run app.pw
# No --lang needed, generates all 8:
# .mcpd/abc123/python/app.py
# .mcpd/abc123/node/server.js
# .mcpd/abc123/go/main.go
# .mcpd/abc123/rust/main.rs
# .mcpd/abc123/dotnet/Program.cs
# .mcpd/abc123/java/Main.java
# .mcpd/abc123/cpp/main.cpp
# .mcpd/abc123/nextjs/pages/index.js
#
# Serves all 8:
# http://127.0.0.1:23456/apps/abc123/python/
# http://127.0.0.1:23456/apps/abc123/node/
# http://127.0.0.1:23456/apps/abc123/go/
# http://127.0.0.1:23456/apps/abc123/rust/
# http://127.0.0.1:23456/apps/abc123/dotnet/
# http://127.0.0.1:23456/apps/abc123/java/
# http://127.0.0.1:23456/apps/abc123/cpp/
# http://127.0.0.1:23456/apps/abc123/nextjs/
```

User picks which to use at runtime, or load-balance across all 8.

---

## Summary

**Promptware supports 8 languages**:

**Tier 1 (Working Now)**:
1. Python âœ…
2. Node.js âœ…
3. Go âœ…

**Tier 2 (In Progress)**:
4. Rust ğŸ”¨
5. .NET ğŸ”¨

**Tier 3 (Planned)**:
6. Java ğŸ“‹
7. C++ ğŸ“‹
8. Next.js ğŸ“‹

**Your instinct is correct**: `.pw` should generate ALL languages simultaneously by default, with `lang` as an optimization. That's the true vision of language-agnostic execution.

**Timeline**: Tier 1 done, Tier 2 by M3-M4 (16 weeks), Tier 3 in future waves.